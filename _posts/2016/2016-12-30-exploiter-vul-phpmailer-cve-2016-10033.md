---
layout: post
title:  "Exploiter la vulnérabilité PHPMailer CVE-2016-10033"
date:   2016-12-30 11:15:00
categories:
    - blog
tags:
    - exploit
    - infosec
    - hacking
    - phpmailer
---

Imaginez plus 9 de millions sites web qui peuvent être piratés en l'espace de
quelques secondes !

Si vous avez suivé l'actualité infosec sur Twitter ou sur les sites spécialisés
ces derniers jours, vous avez alors sûrement entendu parler de la vulnérabilité découverte par le
   chercheur en sécurité informatique polonais [David Golunski \[0\]][0] touchant la
   bibliothèque [PHPMailer \[1\]][1], une des plus populaires libs et les plus utilisées de
   PHP. La faile affecte toutes les versions antérieure à 5.2.18, si un
   attaquant malveillant l'exploite, il pourra alors exécuter du [code arbitraire à distance (RCE) \[2\]][2].

   Cette bibliothèque est utilisée par Wordpress, Drupal, Joomla, SugarCRM, etc.
   Je vous laisse imaginer les dégâts que ça vous causer.

Comme je l'écrit au début, cette faille peut être exploiter en quelques secondes
et avec une facilité ahurissante. Pour vous vous en donner un exemple, on va
utiliser une image docker que vous pouvez installer en exécutant la commande
suivante :

~~~
$ docker pull vulnerables/cve-2016-10033
~~~

Ensuite vous la lancez avec cette commande :

~~~
$ docker run --rm -it -p 8080:80 vulnerables/cve-2016-10033
~~~
![Screenshot PHPMailer]({{ site.baseurl }}images/posts/2016/phpmailer.png "Screenshot - PHPMailer")

Plusieurs exploit ont été publié depuis que la vulnérabilité a été rendu
publique. Dans notre exemple on va utiliser celui qui a été écrit par [opsxcq
\[3\]][3]

~~~
$ git clone https://github.com/opsxcq/exploit-CVE-2016-10033
~~~
![Screenshot exploit phpmailer]({{ site.baseurl }}images/posts/2016/exploit.png "Screenshot - Exploit PHPMailer")

Et voilà, vous avez votre remote shell, maintenant vous essayer d'élever vos
privilèges en exécutant un des scripts que j'ai évoqué dans [ce billet par
exemple \[4\]][4].

P.S Si vous n'avez pas docker, vous pouvez suivre [un de ces guides pour l'installer
\[5\]][5].





### Liens
~~~
[0]: https://twitter.com/dawid_golunski
[1]: https://github.com/PHPMailer/PHPMailer
[2]: https://en.wikipedia.org/wiki/Arbitrary_code_execution
[3]: https://github.com/opsxcq/exploit-CVE-2016-10033
[4]: {{ site.url }}{{ site.baseurl }}blog/4-scripts-elevation-privileges/
[5]: https://docs.docker.com/engine/installation/
~~~

[0]: https://twitter.com/dawid_golunski
[1]: https://github.com/PHPMailer/PHPMailer
[2]: https://en.wikipedia.org/wiki/Arbitrary_code_execution
[3]: https://github.com/opsxcq/exploit-CVE-2016-10033
[4]: {{ site.url }}{{ site.baseurl }}blog/4-scripts-elevation-privileges/
[5]: https://docs.docker.com/engine/installation/

